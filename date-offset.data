[{"_1":2},"routes/package",{"_3":4},"data",{"_5":6,"_43":44,"_45":46},"package",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_19":20,"_21":22,"_31":32,"_33":34,"_41":42},"name","date-offset","author","Stephen Meech","description","A package that uses the date-handling facilities of different scripting languages to return dates variably offset from today, as specified in a regex trigger.","title","Date Offsets","version","0.1.0","archive_url","https://github.com/espanso/hub/releases/latest/download/date-offset-0.1.0.zip","archive_sha256_url","https://github.com/espanso/hub/releases/latest/download/date-offset-0.1.0-sha256.txt","tags",[23,24,25,26,27,28,29,30],"time","date","python","bash","powershell","pwsh","javascript","node.js","id","date-offset-0.1.0","files",{"_35":36,"_37":38,"_39":40},"README.md","# Date Offsets\n\nEspanso's inbuilt `date` extension is handy, but very limited, particularly because it **cannot** accept a `{{variable}}` for its `offset:` value. \n\nThis package contains short Espanso snippets to return dates offset from today, utilising the date-handling facilities of four different scripting languages, partly as an exercise for me in working out how this can be done.\n\nAs supplied, typing a trigger, e.g.:\n```\n-18d, +2w, -3m, +5y\n```\nwill present you with a choice box, listing the different scripts, each of which will return the relevant (hopefully the same!) date.\n\nAny of the languages you don't have installed will generate Espanso errors:\n  - Bash (Linux/macOS) or WSL (Windows)\n  - Powershell (Windows) or pwsh (Linux/macOS)\n  - Python\n  - Javascript\n\nMy tests (Linux) indicate that in speed, Bash > Python > Node > PowerShell, but PowerShell is likely to be faster (but not necessarily the *fastest*) in Windows.\n\nUltimately, adopt one and delete or comment-out the others you don't need.\n\nSee my package `timezone-date` for timezone offsets.\n\nStephen Meech\n(@smeech)\n","package.yml","# yaml-language-server: $schema=https://raw.githubusercontent.com/espanso/espanso/dev/schemas/match.schema.json\r\n\r\n\r\n# Espanso snippets to return offset date from today\r\n# Type e.g.: -18d, +2w, -3m, +5y etc.\r\n\r\nmatches:\r\n# Bash version\r\n  - regex: (?P<offset>[+-]\\d+)(?P<unit>[dwmy])\r\n    replace: \"{{output}}\"\r\n    label: Bash offset date\r\n    vars:\r\n      - name: output\r\n        type: shell\r\n        params:\r\n          shell: bash\r\n          cmd: |           \r\n            case {{unit}} in\r\n                d) date=$(date -d \"{{offset}} days\" +\"%d/%m/%y\") ;;\r\n                w) date=$(date -d \"{{offset}} weeks\" +\"%d/%m/%y\") ;;\r\n                m) date=$(date -d \"{{offset}} months\" +\"%d/%m/%y\") ;;\r\n                y) date=$(date -d \"{{offset}} years\" +\"%d/%m/%y\") ;;\r\n            esac\r\n            echo \"$date\"\r\n\r\n# PowerShell version\r\n  - regex: (?P<offset>[+-]\\d+)(?P<unit>[dwmy])\r\n    replace: \"{{output}}\"\r\n    label: PowerShell offset date\r\n    vars:\r\n      - name: output\r\n        type: shell\r\n        params:\r\n          shell: pwsh\r\n          cmd: |\r\n            switch (\"{{unit}}\") {\r\n                \"d\" { $date = (Get-Date).AddDays({{offset}}).ToString(\"dd/MM/yy\") }\r\n                \"w\" { $date = (Get-Date).AddDays({{offset}} * 7).ToString(\"dd/MM/yy\") }\r\n                \"m\" { $date = (Get-Date).AddMonths({{offset}}).ToString(\"dd/MM/yy\") }\r\n                \"y\" { $date = (Get-Date).AddYears({{offset}}).ToString(\"dd/MM/yy\") }\r\n            }\r\n            Write-Output $date\r\n\r\n# Python version\r\n  - regex: (?P<offset>[+-]\\d+)(?P<unit>[dwmy])\r\n    replace: \"{{output}}\"\r\n    label: Python offset date\r\n    vars:\r\n      - name: output\r\n        type: script\r\n        params:\r\n          args:\r\n            - python\r\n            - -c\r\n            - |\r\n              from datetime import datetime, timedelta\r\n              from dateutil.relativedelta import relativedelta\r\n              now = datetime.now()\r\n              match \"{{unit}}\":\r\n                  case \"d\": date = now + timedelta(days={{offset}})\r\n                  case \"w\": date = now + timedelta(weeks={{offset}})\r\n                  case \"m\": date = now + relativedelta(months={{offset}})\r\n                  case \"y\": date = now + relativedelta(years={{offset}})\r\n              print(date.strftime(\"%d/%m/%y\"))\r\n\r\n# Javascript version\r\n  - regex: (?P<offset>[+-]\\d+)(?P<unit>[dwmy])\r\n    replace: \"{{output}}\"\r\n    label: Javascript offset date\r\n    vars:\r\n      - name: output\r\n        type: script\r\n        params:\r\n          args:\r\n            - node\r\n            - -e\r\n            - |\r\n              let now = new Date();           \r\n              switch('{{unit}}') {\r\n                case 'd': date = new Date(now.setDate(now.getDate() + {{offset}})); break;\r\n                case 'w': date = new Date(now.setDate(now.getDate() + ({{offset}} * 7))); break;\r\n                case 'm': date = new Date(now.setMonth(now.getMonth() + {{offset}})); break;\r\n                case 'y': date = new Date(now.setFullYear(now.getFullYear() + {{offset}})); break;\r\n              }\r\n              const day = (\"0\" + date.getDate()).slice(-2);\r\n              const month = (\"0\" + (date.getMonth() + 1)).slice(-2);\r\n              const year = date.getFullYear().toString().slice(-2);\r\n              console.log(`${day}/${month}/${year}`);","_manifest.yml","name: \"date-offset\"\ntitle: \"Date Offsets\"\ndescription: A package that uses the date-handling facilities of different scripting languages to return dates variably offset from today, as specified in a regex trigger.\nhomepage: \"https://github.com/smeech\"\nversion: 0.1.0\nauthor: Stephen Meech\ntags: [time, date, python, bash, powershell, pwsh, javascript, node.js]\n","repositoryHome","https://github.com/smeech","versions",[16],"isLatest",true]

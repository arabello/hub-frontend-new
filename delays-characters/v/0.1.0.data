[{"_1":2},"package-version",{"_3":4},"data",{"_5":6,"_41":42,"_43":44},"package",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_19":20,"_21":22,"_28":29,"_30":31,"_40":-7},"name","delays-characters","author","Stephen Meech","description","A package to allow delays, and characters not supported by Espanso, to be injected using the Python pynput library.","title","Delays and characters","version","0.1.0","archive_url","https://github.com/espanso/hub/releases/latest/download/delays-characters-0.1.0.zip","archive_sha256_url","https://github.com/espanso/hub/releases/latest/download/delays-characters-0.1.0-sha256.txt","tags",[23,24,25,26,27],"delays","characters","keyboard","control","python","id","delays-characters-0.1.0","files",{"_32":33,"_34":35,"_36":37,"_38":39},"README.md","# Delays-characters\n\nAn Espanso trigger that uses the Python `pynput` library to inject text, *instead* of Espanso. This enables the addition of pauses (sleep), \\<Tab> etc, and other key combinations not supported by Espanso. It can include use of Espanso {{variables}}. \n\nSee https://pynput.readthedocs.io/en/latest/keyboard.html#controlling-the-keyboard for details of the keywords, and https://pynput.readthedocs.io/en/latest/keyboard.html#pynput.keyboard.Key for the key names.\n\nIf necessary, use `python -m pip install pynput` to add pynput to your Python installation. Tested here with Python 3.10 but may work from Python 2.7 or earlier.\n\nSupports keywords \"type\", \"tap\", \"press\", \"release\", and \"sleep\".\n\nThe package includes a sample script which demonstrates a delay and the effect of simulating pressing the \\<Shift> key. For different scripts, copy, and rename, the `package.yml` file into the `espanso/match/` directory. Edit the trigger value and Input list to suit your purpose.\n\nNB. *The variable {{Trig}} **must** match the trigger in length at least, so that `parse_pynput.py` removes the trigger text cleanly.*\n\nA possible future enhancement could be the addition of mouse control.\n","parse_pynput.py","# Intended for use with the delays-characters package.yml file.\n# Uses the Python pynput library to inject text, instead of Espanso. Enables the \n# addition of pauses (sleep) and <Tab> etc. keys and can include Espanso {{variables}}\n# See https://pynput.readthedocs.io/en/latest/keyboard.html#controlling-the-keyboard\n# Supports type, tap, press, release, and sleep\n\nimport argparse, time\ntry:\n    from pynput.keyboard import Controller, Key\nexcept ImportError:\n    import sys\n    print(\"Error: The 'pynput' library is not installed.\", file=sys.stderr)\n    print(\"Install it using: pip install pynput\", file=sys.stderr)\n    sys.exit(1)  # Exit with a non-zero status code to indicate failure\n\n\n# Initialize the keyboard controller\nkeyboard = Controller()\n\ndef parse_and_execute_commands(commands):\n    lines = commands.strip().splitlines()\n\n    for line in lines:\n        line = line.strip()\n        if line.startswith('type'):\n            text = line[len('type '):].strip()\n            keyboard.type(text)\n        \n        elif line.startswith('tap'):\n            key_name = line[len('tap '):].strip().lower()\n            key = getattr(Key, key_name, key_name)\n            keyboard.tap(key)\n        \n        elif line.startswith('press'):\n            key_name = line[len('press '):].strip().lower()\n            key = getattr(Key, key_name, key_name)\n            keyboard.press(key)\n\n        elif line.startswith('release'):\n            key_name = line[len('release '):].strip().lower()\n            key = getattr(Key, key_name, key_name)\n            keyboard.release(key)\n        \n        elif line.startswith('sleep'):\n            time_to_sleep = float(line[len('sleep '):].strip())\n            time.sleep(time_to_sleep)\n\ndef main():\n    # Set up argument parsing\n    parser = argparse.ArgumentParser(description=\"Execute keyboard automation commands.\")\n    parser.add_argument('trig', type=str, help='The trigger key to simulate.')\n    parser.add_argument('input', type=str, help='The input commands to execute.')\n    args = parser.parse_args()\n\n    # Press backspace key as many times as the length of the trigger\n    for _ in args.trig: keyboard.tap(Key.backspace)\n\n    # Parse and execute the input commands\n    if args.input:\n        parse_and_execute_commands(args.input)\n    else:\n        print(\"No input provided.\")\n\n    # Replace trigger for Espanso to remove after the script\n    keyboard.type(args.trig)\n\nif __name__ == \"__main__\":\n    main()\n","package.yml","# yaml-language-server: $schema=https://raw.githubusercontent.com/espanso/espanso/dev/schemas/match.schema.json\n\n# Supports type, tap, press, release, and sleep.\n\n# For new scripts this file may be copied to the espanso/match directory and edited.\n\nmatches:\n  - trigger: :delay    # Remember to include this value in Trig, below.\n    replace: \"{{Output}}\"\n    vars:\n      - name: Trig\n        type: echo\n        params:\n          echo: :delay # This MUST match the trigger text.\n      - name: Input\n        type: echo\n        params:\n          echo: |      # Amend the contents below to suit, adding variables etc.\n            type Hello, World!\n            tap enter\n            type Pausing for one second\n            tap enter\n            sleep 1 \n            type How are you?\n            tap space\n            press shift\n            type I am a bot\n            release shift\n            tap enter\n            type The trigger was \"{{Trig}}\"\n            tap enter\n            tap tab\n            type The End.\n      - name: Output\n        type: script\n        params:\n          args:\n            - python\n            - '%CONFIG%/match/packages/delays-characters/parse_pynput.py' \n            - '{{Trig}}'\n            - '{{Input}}'","_manifest.yml","name: delays-characters\ntitle: Delays and characters\ndescription: A package to allow delays, and characters not supported by Espanso, to be injected using the Python pynput library.\nhomepage: https://github.com/smeech\nversion: 0.1.0\nauthor: Stephen Meech\ntags: [delays, characters, keyboard, control, python]","repositoryHome","versions",[16],"isLatest",true]

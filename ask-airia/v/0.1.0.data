[{"_1":2},"package-version",{"_3":4},"data",{"_5":6,"_49":50,"_51":52},"package",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_19":20,"_21":22,"_29":30,"_31":32,"_47":48},"name","ask-airia","author","Carles Ferrater","description","An Espanso package that enables users to quickly send prompts to Airia Agents.","title","Ask Airia Agent","version","0.1.0","archive_url","https://github.com/espanso/hub/releases/latest/download/ask-airia-0.1.0.zip","archive_sha256_url","https://github.com/espanso/hub/releases/latest/download/ask-airia-0.1.0-sha256.txt","tags",[23,24,25,26,27,28],"LLM","AI","artificial intelligence","prompt","Airia","agent","id","ask-airia-0.1.0","files",{"_33":34,"_35":36,"_37":38,"_39":40,"_41":42,"_43":44,"_45":46},"ask-airia.py","'''\nask-airia.py\nThis script is designed to interact with Airia Agents and get a response based on a user-provided prompt.\n\nAuthor: Carles Ferrater\nDate: 2025-07-07\nVersion: 0.1.0\n\nDescription:\n    This script is designed for integration with Espanso, allowing users to send a prompt to a Airia Agents and receive a direct answer.\n\nFeatures:\n    - Loads configuration (API key, base URL, model) from a .env file in the script directory.\n    - Allows user to select an existing Airia Agent.\n    - Sends the user-provided prompt to the Airia Agents.\n    - Prints the Airia Agents's response to stdout for Espanso to capture.\n\nSuggested Prompt:\n\n\n'''\nimport os\nimport sys\nimport json\nimport requests\nimport re\nfrom dotenv import load_dotenv\n\n\ndef load_info():\n    \"\"\"\n    Loads environment variables from a .env file.\n    If the file does not exist, it raises a FileNotFoundError.\n    \"\"\"\n    env_path = os.path.join(os.path.dirname(__file__), \".env\")\n    if not os.path.exists(env_path):\n        raise FileNotFoundError(f\"❌ Error: Missing .env file in directory: '{os.path.dirname(__file__)}'.\")\n    load_dotenv(env_path)\n\n    if not os.getenv(\"AIRIA_API_KEY\"):\n        raise ValueError(\"❌ Error: AIRIA_API_KEY is not set in the .env file.\")\n\n    if not os.getenv(\"BASE_URL\"):\n        raise ValueError(\"❌ Error: BASE_URL is not set in the .env file.\")\n    \n\ndef get_agent_id(agent_name: str) -> str:\n    \"\"\"\n    Retrieves the agent ID for a given agent name from the configuration file.\n    \n    Args:\n        agent_name (str): The name of the Airia Agent.\n    \n    Returns:\n        str: The ID of the Airia Agent.\n    \n    Raises:\n        ValueError: If the agent name is not found in the configuration.\n    \"\"\"\n    script_dir = os.path.dirname(__file__)\n    config_path = os.path.join(script_dir, \"agent_config.json\")\n    \n    if not os.path.exists(config_path):\n        raise FileNotFoundError(f\"❌ Error: Missing agent configuration file in directory: '{script_dir}'.\")\n\n    with open(config_path, 'r') as f:\n        agents = json.load(f)\n\n    for agent in agents:\n        if agent['name'] == agent_name:\n            return agent['id']\n    \n    raise ValueError(f\"❌ Error: Agent '{agent_name}' not found in configuration.\")\n    \n\ndef ask_airia(prompt: str, agent_name: str) -> str:\n    \"\"\"\n    Sends a prompt to the Airia Agent and returns the response.\n    \n    Args:\n        prompt (str): The user-provided prompt.\n        agent_id (str): The ID of the Airia Agent to use.\n    \n    Returns:\n        str: The response from the Airia Agent.\n    \"\"\"\n    agent_id = get_agent_id(agent_name)\n    load_info()\n    headers = {\n        \"X-API-KEY\": os.getenv(\"AIRIA_API_KEY\"),\n        \"Content-Type\": \"application/json\"\n    }    \n    data = {\n        \"userInput\": prompt,\n        \"asyncOutput\": False,\n    }\n    response = requests.post(\n        f'{os.getenv(\"BASE_URL\")}/v2/PipelineExecution/{agent_id}',\n        headers=headers,\n        json=data\n    )\n    \n    if response.status_code != 200:\n        raise Exception(f\"❌ Error: Failed to get response from Airia Agent. Status code: {response.status_code}, Message: {response.text}\")\n    \n    response_data = response.json()\n    return(response_data['result'])\n    #print(agent_id)\n\n\ndef main() -> None:\n    \"\"\"\n    Main entry point for the script. Parses arguments, validates input, calls ask_ai, and prints the result.\n    \"\"\"\n    if len(sys.argv) != 3:\n        print('❌ Usage error: python ask-airia.py \"<agent-name>\" \"<input>\"')\n        return\n    input = sys.argv[2]\n    if not input.strip():\n        print(\"❌ Error: No prompt text provided!\")\n        return\n    if len(input) > 1000:\n        raise ValueError(\"❌ Error: Input is too long (max 1000 characters).\")\n    if re.search(r\"[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]\", input):\n        raise ValueError(\"❌ Error: Input contains invalid control characters.\")\n    \n    agent_name = sys.argv[1]\n    if not agent_name.strip():\n        print(\"❌ Error: No agent NAME provided!\")\n        return\n    if not re.match(r\"^[\\w\\-]{1,50}$\", agent_name):\n        raise ValueError(\"❌ Error: Agent name contains invalid characters or is too long.\")\n\n    \n    print(output := ask_airia(input, agent_name))\n\n\nif __name__ == \"__main__\":\n    main()","README.md","# ask-airia\n\n**ask-airia** is an [Espanso](https://espanso.org/) package that enables you to interact with [Airia Agents](https://airia.com) directly from your Espanso extension.\n\n## Features\n\n- Run Airia Agents from Espanso using custom triggers.\n- Easily configure and manage multiple Airia Agents.\n\n## Requirements\n\n- **Python 3.8+** must be installed on your system.\n- **python-dotenv** is required for environment variable management.\n- **requests** is required to do HTTP requests to Airia\n\nTo install `python-dotenv`, and `requqests` run:\n```\npython3 -m pip install requests python-dotenv\n\n```\n\n## Installation\n\nTo install from espanso hub: \n\n```\nespanso install ask-airia\n\n```\n\n1. **Configure your agents:**  \n   Edit the `agent_config.json` file to add your Agent IDs and descriptions.  \n   You can add or remove agents as needed following same structure\n\n2. **Set up environment variables:**  \n   Create a `.env` file in this folder and add your Airia domain and API key. Follow the `example.env` for more details\n\n3. **Run the extension** \n    Use *\"<ai\"* to trigger this extension or modify the trigger from the `package.yml` file\n\n    ```\n    <ai\n\n    ```\n\n## Support\n\nFor more information, visit the [Espanso documentation](https://espanso.org/docs/) or [Airia](https://airia.com).\n\n---\n\n\n","package.yml","matches:\n  - trigger: \"<ai\"\n    replace: \"{{output}}\"\n    vars:\n      - name: agent_names\n        type: script\n        params:\n          args:\n            - python3\n            - -c\n            - |\n              import os\n              import json\n              config_path = os.path.join(\"%CONFIG%/match/packages/ask-airia/agent_config.json\")\n              if not os.path.exists(config_path):\n                  raise FileNotFoundError(f\"❌ Error: Missing agent configuration file in %CONFIG%/match/packages/ask-airia/agent_config.json\")\n              with open(config_path, 'r') as f:\n                  agents = json.load(f)\n              for agent in agents:\n                  print(agent.get(\"name\"))        \n      - name: \"prompt\"\n        type: \"form\"\n        params:\n          layout: \"[[text]]\\n\\nInput\\n\\n[[choices]]\"\n          fields:\n            text:\n              multiline: true\n            choices:\n              type: choice\n              values: |\n                {{agent_names}}\n      - name: \"output\"\n        type: \"script\"\n        params:\n          args:\n            - python3\n            - \"%CONFIG%/match/packages/ask-airia/ask-airia.py\"\n            - \"{{prompt.choices}}\"\n            - \"{{prompt.text}}\"\n","requirements.txt","requests\npython-dotenv\n\n\n\nHi there! I hope you're doing well today. Let me know if there's anything I can assist you with.","example.env","BASE_URL=https://mena.api.airia.ai/\nAIRIA_API_KEY=ak-MTQyNjIyMjmyAPIExample","agent_config.json","\n[{\n        \"name\": \"Slack-Agent\",\n        \"description\": \"Creates slack messages\",\n        \"id\": \"1826b5a4-7976-4566-b0f1-df66d56782ae\"\n    },\n    {\n        \"name\": \"Email-Agent\",\n        \"description\": \"Creates email messages\",\n        \"id\": \"0f6b11c0-a943-4715-89c6-b04c42762797\"\n    },\n    {\n        \"name\": \"FollowUp-Agent\",\n        \"description\": \"Follow up on previous messages\",\n        \"id\": \"b1201116-aa38-4f6f-92b5-9565d78b5ae8\"\n    }\n]","_manifest.yml","name: \"ask-airia\"\ntitle: \"Ask Airia Agent\"\ndescription: \"An Espanso package that enables users to quickly send prompts to Airia Agents.\"\nversion: \"0.1.0\"\nauthor: \"Carles Ferrater\"\nhomepage: \"https://github.com/carlescarles/ask-airia/edit/main/README.md\"\ntags: [\"LLM\", \"AI\", \"artificial intelligence\", \"prompt\", \"Airia\", \"agent\"]\n","repositoryHome","https://github.com/carlescarles/ask-airia/edit/main/README.md","versions",[16],"isLatest",true]

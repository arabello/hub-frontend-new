<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/navbar_logo.svg"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pgeq1842-pleq1852.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pclip.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/psrcip-pdstip.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pallow-etc.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pnolog-etc.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfiles.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfilter.gif"/><link rel="preload" as="image" href="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/ptsf.gif"/><title>PAN snippets - Espanso Hub</title><meta name="description" content="Snippets for Palo Alto Networks Firewalls and Panorama"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="modulepreload" href="/assets/entry.client-B_aoCoVg.js"/><link rel="modulepreload" href="/assets/chunk-OIYGIGL5-Ba8ztz7e.js"/><link rel="modulepreload" href="/assets/index-DyJuW5r9.js"/><link rel="modulepreload" href="/assets/root-DtRlfmA7.js"/><link rel="modulepreload" href="/assets/createLucideIcon-Dp8V93Bi.js"/><link rel="modulepreload" href="/assets/package-B6r7Ytj8.js"/><link rel="modulepreload" href="/assets/card-BGu7yhDX.js"/><link rel="modulepreload" href="/assets/separator-COXCAjto.js"/><link rel="modulepreload" href="/assets/shield-Ba_v_8wr.js"/><link rel="stylesheet" href="/assets/root-BHCQwv_u.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&amp;display=swap"/></head><body><div class="min-h-screen flex flex-col"><header class="w-full border-b border-primary/30 border-none text-primary-foreground bg-primary sticky top-0 z-50"><div class="content-row"><div class="flex h-16 items-center gap-4"><a class="flex items-center gap-2" href="/" data-discover="true"><img src="/images/navbar_logo.svg" alt="Espanso Hub" class="h-6 md:h-7 w-auto"/><span class="sr-only">Espanso Hub</span></a><div class="flex-1 max-w-md relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none" aria-hidden="true"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg><input type="text" data-slot="input" class="file:text-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 min-w-0 rounded-md border px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive pl-10 w-full bg-background text-foreground placeholder:text-muted-foreground" placeholder="Search for packages" value=""/></div><div class="hidden md:flex flex-1"></div><nav class="hidden md:flex items-center gap-6"><a href="https://espanso.org/docs/get-started/" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors" target="_blank" rel="noopener noreferrer">Documentation</a><a href="https://espanso.org/docs/next/packages/creating-a-package/" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors" target="_blank" rel="noopener noreferrer">Create Package</a><a class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors" href="/search" data-discover="true">Explore</a></nav><div class="md:hidden"></div></div></div></header><div class="bg-white py-8"><div class="content-row"><div class="space-y-4"><div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4"><div class="flex items-center gap-2 md:gap-8"><h1 class="text-3xl md:text-5xl font-bold">PAN snippets</h1></div><div class="flex items-center gap-2 self-start md:self-auto"><button data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-share2 lucide-share-2 h-4 w-4" aria-hidden="true"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"></line><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"></line></svg></button><a href="https://github.com/itsamemarkus/espanso-pan" target="_blank" rel="noopener noreferrer" aria-label="View on GitHub" data-slot="button" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github h-4 w-4" aria-hidden="true"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button type="button" role="combobox" aria-controls="radix-_R_7535_" aria-expanded="false" aria-autocomplete="none" dir="ltr" data-state="closed" data-slot="select-trigger" data-size="default" class="border-input data-[placeholder]:text-muted-foreground [&amp;_svg:not([class*=&#x27;text-&#x27;])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 w-[130px] md:w-auto">Select version<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down size-4 opacity-50" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button><select aria-hidden="true" tabindex="-1" style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal"></select></div></div><div class="flex flex-col md:flex-row md:items-end gap-6 mt-4"><div class="flex flex-1 flex-col gap-4 md:gap-5"><p class="font-mono text-sm text-muted-foreground">pan-snippets</p><p class="text-sm text-muted-foreground">by <!-- -->Markus Schapdick</p><p class="text-base leading-relaxed">Snippets for Palo Alto Networks Firewalls and Panorama</p><div class="flex flex-wrap gap-2"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">utility</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">palo-alto-networks</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">firewall</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">ngfw</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">networking</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">infosec</span></div></div><div class="flex md:w-1/3 flex-col gap-3 md:gap-5 mt-2 md:mt-0"><div class="bg-muted p-3 rounded-md font-mono text-sm break-all">espanso install pan-snippets</div><button data-slot="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 w-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-4 w-4 mr-2" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>Copy</button></div></div></div></div></div><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px"></div><div dir="ltr" data-orientation="horizontal" data-slot="tabs" class="gap-2 content-row py-8 flex-1 flex flex-col"><div data-slot="card" class="bg-card text-card-foreground gap-6 rounded-xl border py-6 shadow-sm flex-1 flex flex-col"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6"><div data-slot="card-title" class="leading-none font-semibold"><div role="tablist" aria-orientation="horizontal" data-slot="tabs-list" class="bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]" tabindex="-1" data-orientation="horizontal" style="outline:none"><button type="button" role="tab" aria-selected="true" aria-controls="radix-_R_235_-content-description" data-state="active" id="radix-_R_235_-trigger-description" data-slot="tabs-trigger" class="data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Description</button><button type="button" role="tab" aria-selected="false" aria-controls="radix-_R_235_-content-source" data-state="inactive" id="radix-_R_235_-trigger-source" data-slot="tabs-trigger" class="data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Source</button></div></div></div><div data-slot="card-content" class="px-6 flex-1"><div data-state="active" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-_R_235_-trigger-description" id="radix-_R_235_-content-description" tabindex="0" data-slot="tabs-content" class="flex-1 outline-none h-full flex flex-col" style="animation-duration:0s"><p class="text-base leading-relaxed whitespace-pre-wrap"><h1 class="text-4xl font-bold" node="[object Object]">Espanso PAN</h1>
<p>An <a href="https://espanso.org/">espanso</a> package for generating</p>
<ul>
<li>monitor filter syntax</li>
<li>policy filter syntax</li>
<li>CLI commands</li>
</ul>
<p>for Palo Alto Networks Next Generation Firewalls and Panorama.</p>
<p>Espanso is a text expander.</p>
<p>The goal is to save time for daily troubleshooting and admin tasks. Triggers should also work, if you do them in a remote session, because it&#x27;s just like you&#x27;d type the characters yourself.</p>
<p>All triggers start with <code>:p</code> followed by a keyword. For this README file the following convention is used:</p>
<ul>
<li><code>:p</code> trigger identifier for this Espanso package</li>
<li><code>keyword</code> followed by keyword to trigger the specific action. Goal: Easy to remember</li>
<li><code>&lt;dynamic&gt;</code> (only required for a few triggers) dynamic regex part that is required for the completion to work.</li>
</ul>
<p>The list of commands in this README is not exhaustive. You can see all in the <code>package.yml</code> of this package.</p>
<h2 class="text-3xl font-bold" node="[object Object]">Examples Monitor Filter Syntax</h2>
<h3 class="text-2xl font-bold" node="[object Object]">less/greater then or equal custom time</h3>
<p>Syntax: <code>:pleq&lt;time&gt;</code> and <code>:pgeq&lt;time&gt;</code></p>
<p>Example: <code>:pleq1842</code> will be replaced by <code>( receive_time leq &#x27;2025/05/13 18:42:00&#x27; )</code></p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pgeq1842-pleq1852.gif" alt=""/></p>
<h3 class="text-2xl font-bold" node="[object Object]">multiple choice insert current clipboard</h3>
<p>Syntax: <code>:pclip</code></p>
<p>Example: <code>:plcip</code> offers a choice, and then it uses your clipboard content to build the filter syntax. Might help, if you have to manually copy from a ticketing system or similar sources.</p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pclip.gif" alt=""/></p>
<h3 class="text-2xl font-bold" node="[object Object]">source and destination actions</h3>
<p>Syntax: <code>:psrcip</code> or <code>:pdstip</code> or <code>:psrczone</code> or ...</p>
<p>Example: <code>psrcip</code> will be replaced by <code>( addr.src in &#x27;&#x27; )</code> with the cursor position in quotes.</p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/psrcip-pdstip.gif" alt=""/></p>
<h3 class="text-2xl font-bold" node="[object Object]">filter for specific traffic</h3>
<p>Syntax: <code>:pallow</code>, <code>:pdeny</code>, <code>:paction</code>, <code>:p0b</code></p>
<p>Example: <code>:pallow</code> expands to ( action eq &#x27;allow&#x27; )
<img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pallow-etc.gif" alt=""/></p>
<h2 class="text-3xl font-bold" node="[object Object]">Examples: Filter Policies</h2>
<p>Syntax: <code>:pdisabled</code>, <code>:pnolog</code>, <code>:pname</code></p>
<p>Example: <code>:pnolog</code> expands to <code>(log-end eq &#x27;no&#x27;)</code> to show policies with no logging enabled</p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pnolog-etc.gif" alt=""/></p>
<h2 class="text-3xl font-bold" node="[object Object]">Examples: CLI commands</h2>
<h3 class="text-2xl font-bold" node="[object Object]">Set packet capture stage filenames based on current date</h3>
<p><code>:pcapfiles</code> expands to</p>
<pre><code class="language-text">debug dataplane packet-diag set capture stage receive file 2025-05-14_00-24_rc
debug dataplane packet-diag set capture stage firewall file 2025-05-14_00-24_fw
debug dataplane packet-diag set capture stage transmit file 2025-05-14_00-24_tm
debug dataplane packet-diag set capture stage drop file 2025-05-14_00-24_dr
</code></pre>
<p>where the filename contains the current date and time.</p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfiles.gif" alt=""/></p>
<h3 class="text-2xl font-bold" node="[object Object]">Set packet capture filter with CIDR source and/or destination range</h3>
<p><code>:pcapfilter</code> opens a form and expands to</p>
<pre><code class="language-text">debug dataplane packet-diag set filter match source 10.13.37.42 source-netmask 24 destination 9.9.9.9 destination-netmask 32
</code></pre>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfilter.gif" alt=""/></p>
<h3 class="text-2xl font-bold" node="[object Object]">capture helpers</h3>
<p><code>:pcapon</code> expands to <code>debug dataplane packet-diag set capture on</code></p>
<p><code>:pcapoff</code> expands to <code>debug dataplane packet-diag set capture off</code></p>
<p><code>:pcapcounter</code> expands to <code>show counter global filter packet-filter yes delta yes</code></p>
<h3 class="text-2xl font-bold" node="[object Object]">lookup route in FIB</h3>
<p><code>:proutelookup</code> expands to <code>test routing fib-lookup virtual-router default ip</code></p>
<h3 class="text-2xl font-bold" node="[object Object]">export TSF file</h3>
<p><code>:ptsf</code> shows a form to enter scp/ssh details</p>
<p><img src="https://github.com/itsamemarkus/espanso-pan/raw/main/assets/ptsf.gif" alt=""/></p>
<p>and expands to the command that exports the tech support file via scp.</p>
<h3 class="text-2xl font-bold" node="[object Object]">MISC commands</h3>
<p><code>:ptopm</code> top for management-plane expands to <code>show system resources follow</code></p>
<p><code>:ptopd</code> top for data-plane expands to <code>show running resource-monitor</code></p>
<p><code>:pike</code> expands to <code>show vpn ike-sa gateway</code></p>
<p><code>:pipsec</code> expands to <code>show vpn ipsec-sa tunnel</code></p>
<p><code>:pfqdn</code> expands to <code>show dns-proxy fqdn all</code></p>
<p>and more. Check the source of this package.</p>
<h2 class="text-3xl font-bold" node="[object Object]">Contributing: Syntax, trigger considerations</h2>
<p>When I initially had the idea to use <a href="https://espanso.org/">Espanso</a> for this, I thought of having separate triggers for monitor filters, policy filters and terminal commands. Something like</p>
<ul>
<li>p<strong>M</strong>srcip</li>
<li>p<strong>P</strong>name</li>
<li>p<strong>T</strong>info</li>
</ul>
<p>I noticed quite fast that those triggers are harder to remember and decided to just prepend everything with <code>:p</code> and then use very easy to remember names, if possible I used keywords from the original syntax and I even preferred slightly longer ones, like <code>:pallow</code> over <code>:pall</code> (or so). I&#x27;m trying to include commands that might be used very frequently by the majority of admins and troubleshooters.</p>
<p>Although Espanso <a href="https://espanso.org/docs/matches/extensions/#shell-extension">shell extensions</a> can be very powerful, I&#x27;m trying to avoid using them, so that everything works universally on Linux, Mac and Windows and with no dependencies.</p>
<p>I&#x27;m also trying to not include any destructive commands like clearing firewall logs,shutting down the firewall or resetting sc3. You can easily extend your own config with those, if you need them frequently.</p>
<p>Contributions welcome.</p></p></div><div data-state="inactive" data-orientation="horizontal" role="tabpanel" aria-labelledby="radix-_R_235_-trigger-source" hidden="" id="radix-_R_235_-content-source" tabindex="0" data-slot="tabs-content" class="flex-1 outline-none h-full flex flex-col"></div></div></div></div></div><footer class="border-t border-primary/20 bg-primary text-primary-foreground"><div class="content-row py-6"><div class="flex flex-col items-center gap-6 md:flex-row md:items-center md:justify-between"><a class="flex items-center gap-2" href="/" data-discover="true"><img src="/images/navbar_logo.svg" alt="Espanso Hub" class="h-7 w-auto"/><span class="sr-only">Espanso Hub</span></a><a href="https://espanso.org/docs/get-started/" target="_blank" rel="noopener noreferrer" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors">Documentation</a><a href="https://espanso.org/docs/next/packages/creating-a-package/" target="_blank" rel="noopener noreferrer" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors">Create Package</a><a class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors" href="/search" data-discover="true">Explore</a><a href="https://github.com/espanso/hub-frontend/" target="_blank" rel="noopener noreferrer" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors">Contribute</a><a href="https://espanso.org" target="_blank" rel="noopener noreferrer" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors">Espanso</a><a href="https://www.reddit.com/r/espanso/" target="_blank" rel="noopener noreferrer" class="text-sm font-medium text-primary-foreground/90 hover:text-primary-foreground transition-colors">Reddit</a></div><div class="mt-6 flex items-center justify-center gap-2 text-sm text-primary-foreground/90"><span>Made with</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart h-4 w-4" aria-hidden="true"><path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"></path></svg><span>by</span><a href="https://www.matteopellegrino.dev/" target="_blank" rel="noopener noreferrer" class="font-medium underline-offset-4 hover:underline">Matteo Pellegrino</a></div></div></footer><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><script>window.__reactRouterContext = {"basename":"/","future":{"v8_middleware":false,"unstable_optimizeDeps":false,"unstable_splitRouteModules":false,"unstable_subResourceIntegrity":false,"unstable_viteEnvironmentApi":false},"routeDiscovery":{"mode":"lazy","manifestPath":"/__manifest"},"ssr":true,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">;
import * as route0 from "/assets/root-DtRlfmA7.js";
import * as route1 from "/assets/package-B6r7Ytj8.js";
  window.__reactRouterManifest = {
  "entry": {
    "module": "/assets/entry.client-B_aoCoVg.js",
    "imports": [
      "/assets/chunk-OIYGIGL5-Ba8ztz7e.js",
      "/assets/index-DyJuW5r9.js"
    ],
    "css": []
  },
  "routes": {
    "root": {
      "id": "root",
      "path": "",
      "hasAction": false,
      "hasLoader": false,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": true,
      "module": "/assets/root-DtRlfmA7.js",
      "imports": [
        "/assets/chunk-OIYGIGL5-Ba8ztz7e.js",
        "/assets/index-DyJuW5r9.js",
        "/assets/createLucideIcon-Dp8V93Bi.js"
      ],
      "css": [
        "/assets/root-BHCQwv_u.css"
      ]
    },
    "routes/package": {
      "id": "routes/package",
      "parentId": "root",
      "path": ":packageName",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/package-B6r7Ytj8.js",
      "imports": [
        "/assets/chunk-OIYGIGL5-Ba8ztz7e.js",
        "/assets/card-BGu7yhDX.js",
        "/assets/separator-COXCAjto.js",
        "/assets/index-DyJuW5r9.js",
        "/assets/shield-Ba_v_8wr.js",
        "/assets/createLucideIcon-Dp8V93Bi.js"
      ],
      "css": []
    },
    "routes/home": {
      "id": "routes/home",
      "parentId": "root",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasClientMiddleware": false,
      "hasErrorBoundary": false,
      "module": "/assets/home-4hEkyLJ0.js",
      "imports": [
        "/assets/chunk-OIYGIGL5-Ba8ztz7e.js",
        "/assets/card-BGu7yhDX.js",
        "/assets/PackageCard-B8NdNGsH.js",
        "/assets/shield-Ba_v_8wr.js",
        "/assets/createLucideIcon-Dp8V93Bi.js"
      ],
      "css": []
    }
  },
  "url": "/assets/manifest-df0f0420.js",
  "version": "df0f0420"
};
  window.__reactRouterRouteModules = {"root":route0,"routes/package":route1};

import("/assets/entry.client-B_aoCoVg.js");</script><!--$?--><template id="B:0"></template><!--/$--><script id="_R_">requestAnimationFrame(function(){$RT=performance.now()});</script><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_47\":-5,\"_48\":-5},\"loaderData\",{\"_3\":4},\"routes/package\",{\"_5\":6,\"_43\":44,\"_45\":46},\"package\",{\"_7\":8,\"_9\":10,\"_11\":12,\"_13\":14,\"_15\":16,\"_17\":18,\"_19\":20,\"_21\":22,\"_29\":30,\"_31\":32,\"_41\":42},\"name\",\"pan-snippets\",\"author\",\"Markus Schapdick\",\"description\",\"Snippets for Palo Alto Networks Firewalls and Panorama\",\"title\",\"PAN snippets\",\"version\",\"0.1.0\",\"archive_url\",\"https://github.com/espanso/hub/releases/latest/download/pan-snippets-0.1.0.zip\",\"archive_sha256_url\",\"https://github.com/espanso/hub/releases/latest/download/pan-snippets-0.1.0-sha256.txt\",\"tags\",[23,24,25,26,27,28],\"utility\",\"palo-alto-networks\",\"firewall\",\"ngfw\",\"networking\",\"infosec\",\"id\",\"pan-snippets-0.1.0\",\"files\",{\"_33\":34,\"_35\":36,\"_37\":38,\"_39\":40},\"_manifest.yml\",\"name: \\\"pan-snippets\\\"\\ntitle: \\\"PAN snippets\\\"\\ndescription: Snippets for Palo Alto Networks Firewalls and Panorama\\nhomepage: \\\"https://github.com/itsamemarkus/espanso-pan\\\"\\nversion: 0.1.0\\nauthor: Markus Schapdick\\ntags: [\\\"utility\\\", \\\"palo-alto-networks\\\", \\\"firewall\\\", \\\"ngfw\\\", \\\"networking\\\", \\\"infosec\\\"]\\n\",\"package.yml\",\"####################\\n# global variables #\\n####################\\n\\nglobal_vars:\\n  - name: clipb\\n    type: clipboard\\n\\nmatches:\\n\\n  ##################\\n  # Filter Monitor #\\n  ##################\\n\\n  - regex: \\\":pleq(?P\u003chour\u003e\\\\\\\\d{2})(?P\u003cminute\u003e\\\\\\\\d{2})\\\"\\n    # label: less equal time, regex time extraction. Example: :pleq2035\\n    replace: \\\"( receive_time leq '{{datetime}}' )\\\"\\n    vars:\\n      - name: today\\n        type: date\\n        params:\\n          format: \\\"%Y/%m/%d\\\"\\n      - name: datetime\\n        type: echo\\n        params:\\n          echo: \\\"{{today}} {{hour}}:{{minute}}:00\\\"\\n\\n  - regex: \\\":pgeq(?P\u003chour\u003e\\\\\\\\d{2})(?P\u003cminute\u003e\\\\\\\\d{2})\\\"\\n    # label: greater equal time, regex time extraction. Example: pgeq2145\\n    replace: \\\"( receive_time geq '{{datetime}}' )\\\"\\n    vars:\\n      - name: today\\n        type: date\\n        params:\\n          format: \\\"%Y/%m/%d\\\"\\n      - name: datetime\\n        type: echo\\n        params:\\n          echo: \\\"{{today}} {{hour}}:{{minute}}:00\\\"\\n\\n\\n  ### clipboard block start ###\\n  - trigger: :pclip\\n    label: \\\"clipboard: source IP\\\"\\n    replace: \\\"( addr.src in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: destionation IP\\\" \\n    replace: \\\"( addr.dst in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: source user\\\"\\n    replace: \\\"( user.src in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: destination user\\\" \\n    replace: \\\"( user.dst in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: source port\\\" \\n    replace: \\\"( port.src in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: destination port\\\" \\n    replace: \\\"( port.dst in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: source zone\\\" \\n    replace: \\\"( zone.src in '{{clipb}}' )\\\"\\n\\n  - trigger: :pclip\\n    label: \\\"clipboard: destnation zone\\\" \\n    replace: \\\"( zone.dst in '{{clipb}}' )\\\"\\n  ### clipboard block end ###\\n\\n\\n  - trigger: :psrcip\\n    # label: Sourc√ße IP\\n    replace: \\\"( addr.src in '$|$' )\\\"\\n\\n  - trigger: :pdstip\\n    # label: Destination IP\\n    replace: \\\"( addr.dst in '$|$' )\\\"\\n\\n  - trigger: :psrcuser\\n    # label: Username\\n    replace: \\\"(user.src eq '$|$')\\\"\\n\\n  - trigger: :pdstuser\\n    # label: Username\\n    replace: \\\"(user.dst eq '$|$')\\\"\\n\\n  - trigger: :psrcport\\n    # label: Source Port\\n    replace: \\\"(port.src eq '$|$')\\\"\\n\\n  - trigger: :pdstport\\n    # label: Destination Port\\n    replace: \\\"(port.dst eq '$|$')\\\"\\n\\n  - trigger: :psrczone\\n    # label: Source Zone\\n    replace: \\\"(zone.src eq '$|$')\\\"\\n\\n  - trigger: :pdstzone\\n    # label: Destionation Zone\\n    replace: \\\"(zone.dst eq '$|$')\\\"\\n \\n  - trigger: :papp\\n    # label: App\\n    replace: \\\"(app eq '$|$')\\\"\\n\\n  - trigger: :pdecrypt\\n    # label: Decrypted Traffic\\n    replace: \\\"( flags has proxy )\\\"\\n\\n  - trigger: :pnodecrypt\\n    # label: Traffic that is not decrypted\\n    replace: \\\"!( flags has proxy )\\\"\\n\\n  - trigger: :pallow\\n    # label: Allowed Traffic\\n    replace: ( action eq 'allow' )\\n\\n  - trigger: :pdeny\\n    # label: Denied traffic\\n    replace: \\\"( action eq 'deny' )\\\"\\n\\n  - trigger: \\\":paction\\\"\\n    # label: Traffic action\\n    replace: \\\"( action eq {{form1.action_type}} )\\\"\\n    vars:\\n      - name: form1\\n        type: form\\n        params:\\n          layout: |\\n            Which Action?\\n            Action: [[action_type]]\\n          fields:\\n            action_type:\\n              type: choice\\n              values:\\n                - allow\\n                - deny\\n                - drop\\n                - reset-client\\n                - reset-server\\n                - reset-both\\n                - drop-icmp\\n\\n  - trigger: \\\":p0b\\\"\\n    # label: Sessions with no return traffic\\n    replace: \\\"( bytes_received eq '0' )\\\"\\n\\n\\n  ####################\\n  # Filter  Policies #\\n  ####################\\n\\n  - trigger: :pdisabled\\n    replace: \\\"(disabled eq 'yes' )\\\"\\n\\n  - trigger: :pnolog\\n    # label: only show policies where traffic at session end is disabled\\n    replace: \\\"(log-end eq 'no')\\\"\\n\\n  - trigger: \\\":pname\\\"\\n    # label: Shows policies containing string\\n    replace: \\\"(name contains '$|$')\\\"\\n\\n\\n  #######\\n  # CLI #\\n  #######\\n\\n  - trigger: \\\":pcapfiles\\\"\\n    label: \\\"PAN Terminal: capture files \u003e\u003e debug dataplane packet-diag set capture stage...\\\" \\n    # sets filenames for all capture stages: receive, firewall, transmit and drop\\n    replace: |\\n      debug dataplane packet-diag set capture stage receive file {{mydate}}_rc\\n      debug dataplane packet-diag set capture stage firewall file {{mydate}}_fw\\n      debug dataplane packet-diag set capture stage transmit file {{mydate}}_tm\\n      debug dataplane packet-diag set capture stage drop file {{mydate}}_dr\\n    vars:\\n      - name: mydate\\n        type: date\\n        params:\\n          format: \\\"%Y-%m-%d_%H-%M\\\"\\n\\n  - trigger: \\\":pcapfilter\\\"\\n    label: \\\"PAN Terminal: capture filter \u003e\u003e debug dataplane packet-diag set filter...\\\"\\n    # interactively sets the capture filter, compared to web UI it's possible to set a subnet mask here\\n    replace: \\\"debug dataplane packet-diag set filter match source {{form1.src}} source-netmask {{form1.srcnetmask}} destination {{form1.dst}} destination-netmask {{form1.dstnetmask}}\\\"\\n    vars:\\n      - name: form1\\n        type: form\\n        params:\\n          layout: |\\n            Source IP: [[src]]\\n            Source Netmask (CIDR): [[srcnetmask]]\\n            Destination IP: [[dst]]\\n            Destination Netmask: [[dstnetmask]]\\n\\n  - trigger: \\\":pcapcounter\\\"\\n    label: \\\"PAN Terminal: capture counter \u003e\u003e show counter global filter packet-filter yes delta yes\\\"\\n    replace: \\\"show counter global filter packet-filter yes delta yes\\\"\\n\\n  - trigger: \\\":pcapon\\\"\\n    label: \\\"PAN Terminal: capture on \u003e\u003e debug dataplane packet-diag set capture on\\\"\\n    replace: debug dataplane packet-diag set capture on\\n\\n  - trigger: \\\":pcapoff\\\"\\n    label: \\\"PAN Terminal: Capture off \u003e\u003e debug dataplane packet-diag set capture off\\\"\\n    replace: debug dataplane packet-diag set capture off\\n\\n  - trigger: \\\":pcapclear\\\"\\n    label: \\\"PAN Terminal: Capture clear settings \u003e\u003e debug dataplane packet-diag clear all\\\"\\n    replace: debug dataplane packet-diag clear all\\n\\n  - trigger: \\\":pcapmgmt\\\"\\n    label: \\\"PAN Terminal: Capture mgmt plane \u003e\u003e tcpdump\\\"\\n    replace: \\\"tcpdump snaplen 0 filter 'src net {{form1.src}}/{{form1.srcnetmask}} and port {{form1.dstport}}'\\\"\\n    vars:\\n      - name: form1\\n        type: form\\n        params:\\n          layout: |\\n            Source IP: [[src]]\\n            Source Netmask: [[srcnetmask]]\\n            Destination port: [[dstport]]\\n\\n  - trigger: \\\":proutelookup\\\"\\n    label: \\\"PAN Terminal: route \u003e\u003e test routing fib-lookup virtual-router default ip\\\"\\n    replace: \\\"test routing fib-lookup virtual-router default ip $|$\\\"\\n\\n  - trigger: \\\":plogexport\\\"\\n    label: \\\"PAN Terminal: Export log files\\\"\\n    replace: \\\"scp export log-file management remote-port {{form1.port}} to {{form1.user}}@{{form1.host}}:{{form1.path}}\\\"\\n    vars:\\n      - name: form1\\n        type: form\\n        params:\\n          layout: |\\n            User: [[user]]\\n            Host: [[host]]\\n            Path: [[path]]\\n            Port: [[port]]\\n          fields:\\n            port:\\n              default: \\\"22\\\"\\n\\n  - trigger: \\\":ptsf\\\"\\n    label: \\\"PAN Terminal: Export tech support file\\\"\\n    replace: \\\"scp export tech-support remote-port {{form1.port}} to {{form1.user}}@{{form1.host}}:{{form1.path}}\\\"\\n    vars:\\n      - name: form1\\n        type: form\\n        params:\\n          layout: |\\n            User: [[user]]\\n            Host: [[host]]\\n            Path: [[path]]\\n            Port: [[port]]\\n          fields:\\n            port:\\n              default: \\\"22\\\"\\n\\n\\n  - trigger: \\\":ptopm\\\"\\n    replace: \\\"show system resources follow\\\"\\n\\n  - trigger: \\\":ptopd\\\"\\n    replace: \\\"show running resource-monitor\\\"\\n\\n  - trigger: :pjobs\\n    replace: \\\"show jobs all\\\"\\n\\n  - trigger: :plicense\\n    replace: \\\"show license info\\\"\\n\\n  - trigger: :pps\\n    replace: \\\"show system software status\\\"\\n\\n  - trigger: \\\":pdhcp\\\"\\n    replace:  \\\"show dhcp server lease interface all\\\"\\n\\n  - trigger: \\\":ppbf\\\"\\n    replace:  \\\"show session packet-buffer-protection\\\"\\n\\n  - trigger: \\\":pdisk\\\"\\n    replace: \\\"show system disk-space\\\"\\n\\n  - trigger: \\\":pike\\\"\\n    replace: \\\"show vpn ike-sa gateway\\\"\\n\\n  - trigger: \\\":pipsec\\\"\\n    replace: \\\"show vpn ipsec-sa tunnel\\\"\\n\\n  - trigger: \\\":pgroups\\\"\\n    replace: \\\"show user group list\\\"\\n\\n  - trigger: \\\":pfqdn\\\"\\n    replace: \\\"show dns-proxy fqdn all\\\"\\n\\n\\n\",\"README.md\",\"# Espanso PAN\\n\\nAn [espanso](https://espanso.org/) package for generating\\n\\n- monitor filter syntax\\n- policy filter syntax\\n- CLI commands\\n\\nfor Palo Alto Networks Next Generation Firewalls and Panorama.\\n\\nEspanso is a text expander.\\n\\nThe goal is to save time for daily troubleshooting and admin tasks. Triggers should also work, if you do them in a remote session, because it's just like you'd type the characters yourself.\\n\\nAll triggers start with `:p` followed by a keyword. For this README file the following convention is used:\\n\\n- `:p` trigger identifier for this Espanso package\\n- `keyword` followed by keyword to trigger the specific action. Goal: Easy to remember\\n- `\u003cdynamic\u003e` (only required for a few triggers) dynamic regex part that is required for the completion to work.\\n\\nThe list of commands in this README is not exhaustive. You can see all in the `package.yml` of this package.\\n\\n## Examples Monitor Filter Syntax\\n\\n### less/greater then or equal custom time\\n\\nSyntax: `:pleq\u003ctime\u003e` and `:pgeq\u003ctime\u003e`\\n\\nExample: `:pleq1842` will be replaced by `( receive_time leq '2025/05/13 18:42:00' )`\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pgeq1842-pleq1852.gif)\\n\\n### multiple choice insert current clipboard\\n\\nSyntax: `:pclip`\\n\\nExample: `:plcip` offers a choice, and then it uses your clipboard content to build the filter syntax. Might help, if you have to manually copy from a ticketing system or similar sources.\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pclip.gif)\\n\\n### source and destination actions\\n\\nSyntax: `:psrcip` or `:pdstip` or `:psrczone` or ...\\n\\nExample: `psrcip` will be replaced by `( addr.src in '' )` with the cursor position in quotes.\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/psrcip-pdstip.gif)\\n\\n### filter for specific traffic\\n\\nSyntax: `:pallow`, `:pdeny`, `:paction`, `:p0b`\\n\\nExample: `:pallow` expands to ( action eq 'allow' )\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pallow-etc.gif)\\n\\n## Examples: Filter Policies\\n\\nSyntax: `:pdisabled`, `:pnolog`, `:pname`\\n\\nExample: `:pnolog` expands to `(log-end eq 'no')` to show policies with no logging enabled\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pnolog-etc.gif)\\n\\n## Examples: CLI commands\\n\\n### Set packet capture stage filenames based on current date\\n\\n`:pcapfiles` expands to\\n\\n```text\\ndebug dataplane packet-diag set capture stage receive file 2025-05-14_00-24_rc\\ndebug dataplane packet-diag set capture stage firewall file 2025-05-14_00-24_fw\\ndebug dataplane packet-diag set capture stage transmit file 2025-05-14_00-24_tm\\ndebug dataplane packet-diag set capture stage drop file 2025-05-14_00-24_dr\\n```\\n\\nwhere the filename contains the current date and time.\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfiles.gif)\\n\\n### Set packet capture filter with CIDR source and/or destination range\\n\\n`:pcapfilter` opens a form and expands to\\n\\n```text\\ndebug dataplane packet-diag set filter match source 10.13.37.42 source-netmask 24 destination 9.9.9.9 destination-netmask 32\\n```\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/pcapfilter.gif)\\n\\n### capture helpers\\n\\n`:pcapon` expands to `debug dataplane packet-diag set capture on`\\n\\n`:pcapoff` expands to `debug dataplane packet-diag set capture off`\\n\\n`:pcapcounter` expands to `show counter global filter packet-filter yes delta yes`\\n\\n### lookup route in FIB\\n\\n`:proutelookup` expands to `test routing fib-lookup virtual-router default ip`\\n\\n### export TSF file\\n\\n`:ptsf` shows a form to enter scp/ssh details\\n\\n![](https://github.com/itsamemarkus/espanso-pan/raw/main/assets/ptsf.gif)\\n\\nand expands to the command that exports the tech support file via scp.\\n\\n### MISC commands\\n\\n`:ptopm` top for management-plane expands to `show system resources follow`\\n\\n`:ptopd` top for data-plane expands to `show running resource-monitor`\\n\\n`:pike` expands to `show vpn ike-sa gateway`\\n\\n`:pipsec` expands to `show vpn ipsec-sa tunnel`\\n\\n`:pfqdn` expands to `show dns-proxy fqdn all`\\n\\nand more. Check the source of this package.\\n\\n## Contributing: Syntax, trigger considerations\\n\\nWhen I initially had the idea to use [Espanso](https://espanso.org/) for this, I thought of having separate triggers for monitor filters, policy filters and terminal commands. Something like\\n\\n- p**M**srcip\\n- p**P**name\\n- p**T**info\\n\\nI noticed quite fast that those triggers are harder to remember and decided to just prepend everything with `:p` and then use very easy to remember names, if possible I used keywords from the original syntax and I even preferred slightly longer ones, like `:pallow` over `:pall` (or so). I'm trying to include commands that might be used very frequently by the majority of admins and troubleshooters.\\n\\nAlthough Espanso [shell extensions](https://espanso.org/docs/matches/extensions/#shell-extension) can be very powerful, I'm trying to avoid using them, so that everything works universally on Linux, Mac and Windows and with no dependencies.\\n\\nI'm also trying to not include any destructive commands like clearing firewall logs,shutting down the firewall or resetting sc3. You can easily extend your own config with those, if you need them frequently.\\n\\nContributions welcome.\\n\",\"LICENSE\",\"MIT License\\n\\nCopyright (c) [2025] [Markus Schapdick]\\n\\nPermission is hereby granted, free of charge, to any person obtaining a copy\\nof this software and associated documentation files (the \\\"Software\\\"), to deal\\nin the Software without restriction, including without limitation the rights\\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\ncopies of the Software, and to permit persons to whom the Software is\\nfurnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all\\ncopies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\\nSOFTWARE.\",\"repositoryHome\",\"https://github.com/itsamemarkus/espanso-pan\",\"versions\",[16],\"isLatest\",true,\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>$RB=[];$RV=function(a){$RT=performance.now();for(var b=0;b<a.length;b+=2){var c=a[b],e=a[b+1];null!==e.parentNode&&e.parentNode.removeChild(e);var f=c.parentNode;if(f){var g=c.previousSibling,h=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d||"/&"===d)if(0===h)break;else h--;else"$"!==d&&"$?"!==d&&"$~"!==d&&"$!"!==d&&"&"!==d||h++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;e.firstChild;)f.insertBefore(e.firstChild,c);g.data="$";g._reactRetry&&requestAnimationFrame(g._reactRetry)}}a.length=0};
$RC=function(a,b){if(b=document.getElementById(b))(a=document.getElementById(a))?(a.previousSibling.data="$~",$RB.push(a,b),2===$RB.length&&("number"!==typeof $RT?requestAnimationFrame($RV.bind(null,$RB)):(a=performance.now(),setTimeout($RV.bind(null,$RB),2300>a&&2E3<a?2300-a:$RT+300-a)))):b.parentNode.removeChild(b)};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script></body></html>
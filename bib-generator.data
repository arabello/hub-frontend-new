[{"_1":2},"routes/package",{"_3":4},"data",{"_5":6,"_41":42,"_43":44},"package",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_17":18,"_19":20,"_21":22,"_26":27,"_28":29,"_40":-7},"name","bib-generator","author","Xeophon","description","Generate a BibTex entry by searching through DBLP","title","Bib Generator","version","1.0.0","archive_url","https://github.com/espanso/hub/releases/latest/download/bib-generator-1.0.0.zip","archive_sha256_url","https://github.com/espanso/hub/releases/latest/download/bib-generator-1.0.0-sha256.txt","tags",[23,24,25],"bib","academia","research","id","bib-generator-1.0.0","files",{"_30":31,"_32":33,"_34":35,"_36":37,"_38":39},"_manifest.yml","name: \"bib-generator\"\r\ntitle: \"Bib Generator\"\r\nhomepage: https://github.com/Xeophon/hub/tree/main/packages/bib-generator\r\ndescription: Generate a BibTex entry by searching through DBLP\r\nversion: 1.0.0\r\nauthor: Xeophon\r\ntags: [\"bib\", \"academia\", \"research\"]\r\n","bib_generator.py","import sys\r\nimport urllib.request\r\nimport urllib.parse\r\nimport re\r\n\r\n\r\ndef get_bib_info(bib):\r\n    \"\"\"Extracts author, title, and year from a given bib entry.\"\"\"\r\n    author = re.search(r\"author\\s*=\\s*{(.*?)}\", bib, re.DOTALL)\r\n    if author is None:\r\n        author = re.search(r\"editor\\s*=\\s*{(.*?)}\", bib, re.DOTALL)\r\n    author = author.group(1) if author is not None else \"Unknown\"\r\n    title = re.search(r\"title\\s*=\\s*{(.*?)}\", bib, re.DOTALL).group(1)\r\n    year = re.search(r\"year\\s*=\\s*{(.*?)}\", bib).group(1)\r\n    return author, title, year\r\n\r\n\r\ndef format_bib_key(author, title, year):\r\n    \"\"\"Formats the bib key using author's last name, first three words of the title, and the year.\"\"\"\r\n    author_lastname = author.split(\" and\")[0].split()[-1].lower()\r\n    first_three_words = \"\".join(\r\n        re.sub(r\"[^a-zA-Z]\", \"\", word) for word in title.split()[:3]\r\n    )\r\n    key = f\"{author_lastname}{first_three_words}{year}\"\r\n    return key\r\n\r\n\r\ndef extract_url(selected_entry):\r\n    \"\"\"Extracts the URL part from the selected entry in the espanso form\"\"\"\r\n    pattern = r\"\\(([^()]*\\/.*\\/[^()]*)\\)$\"\r\n    match = re.search(pattern, selected_entry)\r\n    if match:\r\n        return match.group(1)\r\n    else:\r\n        return None\r\n\r\n\r\ndef get_bib(selected_entry):\r\n    \"\"\"Gets the bib from the selected entry in the espanso form\"\"\"\r\n    full_url = f\"https://dblp.org/rec/{extract_url(selected_entry)}.bib\"\r\n    with urllib.request.urlopen(full_url) as bib_response:\r\n        bib = bib_response.read().decode()\r\n        if \"not found\" not in bib:\r\n            author, title, year = get_bib_info(bib)\r\n            key = format_bib_key(author, title, year)\r\n            output = re.sub(r\"\\{DBLP:.*?\\,\", \"{\" + key + \",\", bib)\r\n        else:\r\n            output = \"Not found in DBLP\"\r\n    print(output)\r\n\r\n\r\ntry:\r\n    get_bib(sys.argv[1])\r\nexcept Exception as e:\r\n    output = str(e)\r\n","dblp_multi_search.py","import urllib.request\r\nimport urllib.parse\r\nimport json\r\nimport sys\r\n\r\n\r\ndef search(query):\r\n    \"\"\"Searches for a publication and retrieves the top 5 matches.\"\"\"\r\n    options = {\"q\": query, \"format\": \"json\", \"h\": 5}\r\n    output = \"\"\r\n    url = f\"https://dblp.org/search/publ/api?{urllib.parse.urlencode(options)}\"\r\n    with urllib.request.urlopen(url) as response:\r\n        data = json.loads(response.read().decode())\r\n        hit = data.get(\"result\", {}).get(\"hits\", {}).get(\"hit\", [])\r\n\r\n        if hit:\r\n            for item in hit:\r\n                info = item.get(\"info\", {})\r\n                title = info.get(\"title\", \"No title found\")\r\n                output += f\"{title} ({info.get('url').replace(\"https://dblp.org/rec/\", \"\")})\\n\"\r\n        else:\r\n            print(\"No results found in DBLP\")\r\n    print(output.strip())\r\n\r\n\r\ntry:\r\n    search(sys.argv[1])\r\nexcept Exception as e:\r\n    output = str(e)\r\n","README.md","# bib-generator\r\nGenerates a bib entry from a matching regex using espanso.\r\n\r\nRequires Python 3 installed on your system.\r\n\r\n## Usage\r\nJust write `:cite:<your search>:` anywhere, it will show 5 results in a form and then replace your text with the .bib entry you selected in the form. It uses the [DBLP](https://dblp.org/) API under the hood, which is restricted to computer science papers only. I highly recommend searching with `<Author> <Some parts of the title>` to improve the search results, as `<Some parts of the title>` often results in irrelevant results.\r\n\r\nNote: Espanso limits the regex matches to 30 characters ([Source](https://github.com/espanso/espanso/security)), so you must limit your query.","package.yml","matches:\r\n  - regex: \":cite:(?P<citation>.*?):\"\r\n    replace: \"{{final}}\"\r\n    vars:\r\n      - name: dblp_search_results\r\n        type: script\r\n        params:\r\n          args:\r\n            - python\r\n            - \"%CONFIG%/match/packages/bib-generator/dblp_multi_search.py\"\r\n            - \"{{citation}}\"\r\n      - name: form1\r\n        type: form\r\n        params:\r\n          layout: |\r\n            Select bib entry:\r\n            [[entries]]\r\n          fields:\r\n            entries:\r\n              type: list\r\n              values: \"{{dblp_search_results}}\"\r\n      - name: final\r\n        type: script\r\n        params:\r\n          args:\r\n            - python\r\n            - \"%CONFIG%/match/packages/bib-generator/bib_generator.py\"\r\n            - \"{{form1.entries}}\"","repositoryHome","versions",[16],"isLatest",true]
